"use strict";function Tracksale(){var e=null,t={},n=90,a=null,o="",i="",r="tracksale-widget",c=function(){for(var e=r+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var a=t[n];" "===a.charAt(0);)a=a.substring(1);if(-1!=a.indexOf(e))return a.substring(e.length,a.length)}return null},l=function(e,t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3);var a="expires="+n.toUTCString();document.cookie=r+"="+e+"; "+a+"; path=/"},d=function(){var e=localStorage.getItem(r);if(null!==e){e=JSON.parse(e);return(new Date).getTime()>e.timestamp?(localStorage.removeItem(r),null):e.value}return null},s=function(e,t){var n=new Date,a=n.getTime()+24*t*60*60*1e3,o={value:e,timestamp:a};localStorage.setItem(r,JSON.stringify(o))},m=function(){return e.localStorage?d():c()},u=function(t,n){if(e.localStorage)return void s(t,n);l(t,n)},p=function(){var t=m();if(null===t)return!0;var n="";return void 0!==e.identification&&""!==e.identification?n=e.identification:void 0!==e.email&&""!==e.email&&(n=e.email),n!==t},f=function(){""===i?document.querySelector("meta[name=viewport]").parentNode.removeChild(document.querySelector("meta[name=viewport]")):document.querySelector("meta[name=viewport]").setAttribute("content",i)},g=function(o){var i=o.data;if("string"==typeof i)if("close-tracksale"===i||"close-tracksale-now"===i)u(""!==e.identification?e.identification:e.email,n),"embedded"!==a&&setTimeout(function(){document.getElementById("tracksale-wrapper").style.display="none"},"close-tracksale"===i?3e3:0),f();else if("ready-tracksale"===i){if(u(""!==e.identification?e.identification:e.email,e.reminder),document.getElementById("tracksale-iframe").contentWindow.postMessage(e,"*"),document.getElementById("tracksale-wrapper").style.display="block","embedded"===a){var r=document.getElementById(e.appendTo);null!==r&&(r.style.display="block")}"function"==typeof t.onOpen&&t.onOpen(e)}else"close"===i&&(u(""!==e.identification?e.identification:e.email,e.reminder),document.getElementById("tracksale-wrapper").style.display="none","function"==typeof t.onClose&&t.onClose(e),f());else"object"==typeof i&&("answer"===i.event?"function"==typeof t.onAnswer&&t.onAnswer(i.data,e):"updateInfo"===i.event?"function"==typeof t.onUpdateInfo&&t.onUpdateInfo(i.data,e):"grow"===i.event&&(document.getElementById("tracksale-wrapper").style.height=i.data.height+"px",document.getElementById("tracksale-iframe").style.height=i.data.height+"px"))},y=function(){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href="https://cdn.tracksale.co/tracksale-js/external/"+a+".css?v=1.1.4",e.id="tracksale-theme",document.body.appendChild(e)},v=function(e){var t=[];for(var n in e)"campaign"!==n&&"key"!==n&&"type"!==n&&"theme"!==n&&"email"!==n&&"identification"!==n&&"name"!==n&&"reminder"!==n||e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},h=function(){var e=document.getElementsByTagName("meta");if(e&&void 0!==e)for(var t=0;t<e.length;t++)"viewport"===e[t].getAttribute("name")&&(i=e[t].getAttribute("content"));if(""===i){var n=document.createElement("meta");n.name="viewport",n.content="user-scalable=no",document.getElementsByTagName("head")[0].appendChild(n)}else-1===i.indexOf("user-scalable")&&document.querySelector("meta[name=viewport]").setAttribute("content",i+", user-scalable=no")},w=function(){var t=document.getElementById("tracksale-wrapper");if(null===t){y(),h(),t=document.createElement("div"),t.id="tracksale-wrapper",t.style.display="none",t.className=o;var n=document.createElement("div");n.id="tracksale-content";var i=document.createElement("iframe");i.id="tracksale-iframe",i.src="https://tracksale.co/widget/?"+v(e),i.setAttribute("frameborder","0"),"modal"!==a&&n.appendChild(i),t.appendChild(n),"modal"===a&&t.appendChild(i),"modal"===a&&(n.onclick=function(){document.getElementById("tracksale-wrapper").style.display="none",document.getElementById("tracksale-iframe").contentWindow.postMessage("close-ui","*")});var r=null;"embedded"===a&&(r=document.getElementById(e.appendTo)),null===r?document.body.appendChild(t):(r.style.display="none",r.appendChild(t))}},k=function(){var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");do{t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(n[0]);return e>4?e:document.documentMode}(),E=function(t){if(void 0===e.campaign||void 0===e.key)return void t(!1,!0,"Check widget settings.");if("tst"===e.campaign&&"tst"===e.key)return a=e.theme,void t(!0);if(k<10||"function"!=typeof window.postMessage)return void t(!1,!0,"Can't open in this browser.");if(!p())return void t(!1,!1,"Cookie rule.");var i;i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var r=JSON.parse(i.responseText);1==r.success?(n=r.expire_after,a=r.type,o=r.style,e.reminder=r.reminder,t(!0)):t(!1,!1,r.msg)}},i.open("GET","https://tracksale.co/widget/check?"+v(e)),i.send()},I=function(){["onClose","onOpen","onAnswer","onError","onWarning","onUpdateInfo"].forEach(function(n){"function"==typeof e[n]&&(t[n]=e[n]),delete e[n]})},b=function(){try{return localStorage.setItem("ts","ts"),localStorage.removeItem("ts"),!0}catch(e){return!1}},T=function(t){e=t,e.name=e.name||"",e.identification=e.identification||"",e.email=e.email||"",e.salute=e.salute||"",e.tags=e.tags||{},e.thanks=e.thanks||"",e.appendTo=e.appendTo||"",(void 0===e.require_comment||!0!==e.require_comment&&!1!==e.require_comment)&&(e.require_comment=!1),e.reminder=parseInt(e.reminder),(isNaN(e.reminder)||e.reminder<0)&&(e.reminder=90),e.localStorage=b()&&(e.localStorage||!1),I()};this.init=function(n){T(n),E(function(n,a,o){n?w():a?("function"==typeof t.onError&&t.onError({msg:o},e),console.error(o)):("function"==typeof t.onWarning&&t.onWarning({msg:o},e),console.warn(o))})},window.addEventListener("message",g)}